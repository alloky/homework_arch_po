# Докерезированный POCO сервер

- Для работы необходимы docker и docker compose на хост машине

**Осторожно!** В контейнер пробрасываются ssh ключи (не разобрался как без этого законнектиться в контейнер по ssh)
Также скрипты start.sh и restart.sh удаляют localhost:1234 из known_hosts

# Структура

- code - пробрасывается как volume в контейнер
- Dockerfile - конфиг контейнера с сервером, также в него добавлен ssh сервер, чтобы можно было коннектиться через vscode
- docker-compose.yml - конфигурирует контейнер с сервером и контейнер с базой

Скрипты:

- start.sh - поднять всё, использя кэш
- restart.sh - поднять без кэша
- test.sh - протестировать запросы через curl

# (*Небольшие костыли* зачеркнуто) Процесс инициализации:

После поднятия контейнера необходимо зайти в него и выполнить  внутри build - conan_install.sh.

Затем законнектиться через vscode по ssh в конейнер и поставить extensions (Cmake, CMakeTools, C/C++) vscode внутрь контейнера.

Далее выполнить CMake build.
Далее выполнить create_db.sh
<!-- Далее выполнить Run > Run Without Debugging -->

Если при заходе на localhost:1234 в браузере показывается время - значит вссё ок.

# Тестирование

Запросы можно проверить при помощи test.sh из хост машины


# Плюсы и минусы

"+"
- IaC
- Работает одинаково на разных машинах
- Не нужно настраивать виртуальную машину вручную

"-"
- При пересоздании контейнера сбрасываются некоторые его настройти, а также его fingerprint в know_host, что заставляет сбрасывать его вручную
- Дебаггинг в vscode не удобен, т.к. у него бедный функционал по сравнению с visual studio и clion 
- Не нашел решения некоторым проблемам, поэтому остались шаги в ручном режиме